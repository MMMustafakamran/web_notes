# MongoDB Study Notes

## Introduction to MongoDB
- MongoDB is a NoSQL database, open-source, cross-platform, document-oriented, written in C++.
- It provides high performance, high availability, and automatic scaling.
- Developed and supported by 10gen.
- Works on the concept of collection and document.

## Installation
- Download MongoDB from https://www.mongodb.com.
- Or use MongoDB cloud service: https://www.mongodb.com/cloud/atlas.

## Key Concepts
### Database
- Physical container for collections.
- Each database has its own set of files.
- A single MongoDB server can host multiple databases.

### Collection
- Group of MongoDB documents.
- Equivalent to an RDBMS table.
- Exists within a single database.
- Does not enforce a schema.
- Documents in a collection can have different fields.
- Typically all documents in a collection are related.

### Document
- Set of key-value pairs.
- Dynamic schema: documents in same collection can have different fields and structure.
- Common fields may hold different data types.

## RDBMS vs MongoDB Terminology
| RDBMS         | MongoDB           |
|---------------|-------------------|
| Database      | Database          |
| Table         | Collection        |
| Tuple/Row     | Document          |
| Column        | Field             |
| Table Join    | Embedded Documents|
| Primary Key   | Primary Key (Default _id by MongoDB) |

## Sample Document Example
```json
{
   "_id": ObjectId("7df78ad8982c"),
   "title": "MongoDB Overview",
   "description": "MongoDB is no sql database",
   "url": "http://www.something.com",
   "tags": ["mongodb", "database", "NoSQL"],
   "likes": 100,
   "comments": [
      {
         "user": "user1",
         "message": "My first comment",
         "dateCreated": new Date(2011,1,28,7,45),
         "like": 0
      },
      {
         "user": "user2",
         "message": "My second comments",
         "dateCreated": new Date(2011,1,25,7,45),
         "like": 5
      }
   ]
}
```

## Advantages of MongoDB over RDBMS
- Schema-less: collections hold varied documents.
- Clear object structure.
- No complex joins.
- Deep query support using document-based query language.
- Easy to scale.
- No object-relational mapping needed.
- Uses internal memory for faster data access.

## Why Use MongoDB?
- JSON-style document storage.
- Indexing on any attribute.
- Replication and high availability.
- Rich queries.
- Fast in-place updates.
- Professional support.

## Database Commands
### use Command
- Creates or switches to a database.
- **Syntax**: `use DATABASE_NAME`
- **Example**:
  ```bash
  > use mydb
  switched to db mydb
  ```
- Check current database: `db`
- List all databases: `show dbs`

### dropDatabase() Method
- Deletes the selected database.
- **Syntax**: `db.dropDatabase()`
- **Example**:
  ```bash
  > show dbs
  local   0.7812568
  mydb    0.2381268
  test    0.2391268
  > use mydb
  switched to db mydb
  > db.dropDatabase()
  { "dropped" : "mydb", "ok" : 1 }
  ```

## Collection Commands
### createCollection() Method
- Creates a collection.
- **Syntax**: `db.createCollection(name, options)`
- **Parameters**:
  - `name`: String – name of collection.
  - `options`: Document (optional) – configuration like size, indexing.
- **Options fields**:
  - `capped`: Boolean – enables fixed-size collection.
  - `autoIndexId`: Boolean – auto-index on `_id`.
  - `size`: Number – max size in bytes for capped collection.
  - `max`: Number – max documents in capped collection.

#### Examples
Without options:
```bash
> use test
switched to db test
> db.createCollection("mycollection")
{ "ok" : 1 }
```
Check collections: `show collections`

With options (note error in example):
```bash
> db.createCollection("mycol", { capped: true, autoIndexID: true, size: 6142800, max: 10000 })
{
  "ok": 0,
  "errmsg": "BSON field 'create.autoIndexID' is an unknown field.",
  "code": 40415,
  "codeName": "Location40415"
}
```

### Automatic Collection Creation
- Collection is created automatically on first document insert.
- **Example**:
  ```bash
  > db.new_collection.insert({"name": "Hello"})
  WriteResult({ "nInserted": 1 })
  ```

### drop() Method
- Removes a collection.
- **Syntax**: `db.COLLECTION_NAME.drop()`
- **Example**:
  ```bash
  > use mydb
  switched to db mydb
  > show collections
  mycol
  mycollection
  > db.mycollection.drop()
  true
  > show collections
  mycol
  ```
- Returns `true` if successful.

## Document Operations
### insert() Method
- Inserts data into collection.
- **Syntax**: `db.COLLECTION_NAME.insert(document)`

### find() Method
- Queries data from collection.
- **Syntax**: `db.COLLECTION_NAME.find()`
- Displays all documents in non-structured way.

### update() Method
- Updates existing document values.
- **Syntax**: `db.COLLECTION_NAME.update(SELECTION_CRITERIA, UPDATED_DATA)`

### save() Method
- Replaces existing document with new one.
- **Syntax**: `db.COLLECTION_NAME.save({_id:ObjectId(), NEW_DATA})`

### remove() Method
- Removes document(s) from collection.
- **Syntax**: `db.COLLECTION_NAME.remove(DELETION_CRITERIA, JUSTONE)`
- **Parameters**:
  - `DELETION_CRITERIA`: Optional – specifies which documents to remove.
  - `JUSTONE`: Optional – if `true` or `1`, removes only one document.

#### Examples
Remove only one document:
```bash
> db.COLLECTION_NAME.remove(DELETION_CRITERIA, 1)
```

Remove all documents:
```bash
> db.mycol.remove({})
WriteResult({ "nRemoved" : 2 })
> db.mycol.find()
```